/**
 * Module dependencies
 */

var should = require('should');
var util = require('util');
var path = require('path');
var Controller = require('../lib/controller');

/**
 * Tests
 */

describe('Controller', function() {
  var appDir = path.join(__dirname, 'test', 'testdir');
  var app = {
    get: function(key) {
      switch(key) {
        case 'appDir':
          return appDir;
          break;
      }
    }
  }
  var controllerPath = '/path';
  var req = {}
  var next = function() {}
  
  describe('.render()', function() {
    it('should call res.render with 3 arguments', function(done) {
      var res = {
        render: function(view, locals, callback) {
          view.should.equal('view');
          locals['foo'].should.equal('bar');
          callback.should.be.a('function');
          done();
        }
      }
      
      var controller = new Controller(app, req, res, next, controllerPath);
      controller.render('view', {foo: 'bar'}, function() {});
    });
    
    it('should shift arguments one left when there are 2', function(done) {
      var res = {
        render: function(view, locals, callback) {
          view.should.equal('path');
          locals['foo'].should.equal('bar');
          callback.should.be.a('function');
          done();
        }
      }
      
      var controller = new Controller(app, req, res, next, controllerPath);
      controller.render({foo: 'bar'}, function() {});
    });
    
    it('should shift arguments 2 left when there is 1', function(done) {
      var res = {
        render: function(view, locals, callback) {
          view.should.equal('path');
          locals.should.be.a('object');
          callback.should.be.a('function');
          done();
        }
      }
      
      var controller = new Controller(app, req, res, next, controllerPath);
      controller.render(function() {});
    });
  });
});